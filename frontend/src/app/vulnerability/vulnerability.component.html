<div class="container-fluid">
  <p-table #vulnTable [value]="vulnAry" [paginator]="true" [rows]="10" styleClass="p-datatable-striped">
    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="id">Vulnerability ID<p-sortIcon field="id"></p-sortIcon>
        </th>
        <th pSortableColumn="name">Vulnerability Name<p-sortIcon field="name"></p-sortIcon>
        </th>
        <th pSortableColumn="risk">Risk<p-sortIcon field="risk"></p-sortIcon>
        </th>
        <th pSortableColumn="systemic">Systemic<p-sortIcon field="systemic"></p-sortIcon>
        </th>
        <th scope="col">Jira URL</th>
        <th scope="col">Status</th>
        <th scope="col">Actions</th>
      </tr>
      <tr>
        <th>
          <input pInputText type="text" (input)="vulnTable.filter($event.target.value, 'id', 'equals')"
            placeholder="Search by ID" class="p-column-filter">
        </th>
        <th>
          <input pInputText type="text" (input)="vulnTable.filter($event.target.value, 'name', 'startsWith')"
            placeholder="Search by Name" class="p-column-filter">
        </th>
        <th>
          <p-multiSelect [options]="risks" placeholder="All" (onChange)="onRiskChange($event)" optionLabel="name"
            styleClass="p-column-filter">
            <ng-template let-option pTemplate="item">
              <div class="p-multiselect-representative-option">
                <span class="p-ml-1">{{option.name}}</span>
              </div>
            </ng-template>
          </p-multiSelect>
        </th>
        <th>
          <!-- No need for Systemic filter as it's only yes or no-->
        </th>
        <th>
          <input pInputText type="text" (input)="vulnTable.filter($event.target.value, 'jiraId', 'contains')"
            placeholder="Search by Jira ID" class="p-column-filter">
        </th>
        <th>
          <p-multiSelect [options]="statuses" placeholder="All" (onChange)="onStatusChange($event)" optionLabel="name"
            styleClass="p-column-filter">
            <ng-template let-option pTemplate="item">
              <div class="p-multiselect-representative-option">
                <span class="p-ml-1">{{option.name}}</span>
              </div>
            </ng-template>
          </p-multiSelect>
        </th>
        <th></th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-vuln>
      <tr>
        <td scope="row">{{ vuln?.id }}</td>
        <td>{{ vuln?.name }}</td>
        <td>{{ vuln?.risk }}</td>
        <td>{{ vuln?.systemic }}</td>
        <td>
          <a target="_blank" [href]="vuln?.jiraId">{{ vuln?.jiraId }}</a>
        </td>
        <td>{{ vuln?.status }}</td>
        <td>
          <button (click)="navigateToVulnerabilityFormById(vuln.id)" class="btn btn-secondary" type="button"
            style="margin-right: 10px;">
            <i *ngIf="!readOnly" class="pi pi-pencil"></i>
            <i *ngIf="readOnly" class="pi pi-eye"></i>
          </button>
          <button *ngIf="!readOnly" (click)="deleteVuln(vuln)" class="btn btn-dark" type="button">
            <i class="pi pi-trash"></i>
          </button>
        </td>
      </tr>
    </ng-template>
  </p-table>
  <button *ngIf="!readOnly" (click)="navigateToVulnerabilityForm()" type="button" class="btn btn-primary float-right">
    Create Vulnerability
  </button>
  <button (click)="navigateToReport()" type="button" class="btn btn-info float-right" style="margin-right: 5px">
    Preview Report
  </button>
  <button (click)="navigateToAssessments()" type="button" class="btn btn-secondary float-right"
    style="margin-right: 5px">
    Back to Assessments
  </button>
</div>
